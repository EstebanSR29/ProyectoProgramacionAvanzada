--RegistrarUsuario

CREATE PROCEDURE RegistrarUsuario
	@Nombre varchar(100),
	@Correo varchar(100),
	@Contrasenna varchar(20)
AS
BEGIN
	IF (NOT EXISTS(SELECT 1 FROM Usuarios WHERE Correo = @Correo))
	BEGIN
		INSERT INTO Usuarios(Nombre, Correo,Contrasenna,Estado,IdRol)
		VALUES (@Nombre,@Correo,@Contrasenna,1,1)
	END
END

--IniciarSesion

CREATE PROCEDURE IniciarSesion
	@Correo varchar(100),
	@Contrasenna varchar(20)
AS
BEGIN
	SELECT IdUsuario, Nombre, Correo, Estado, IdRol 
	FROM Usuarios
	WHERE Correo = @Correo
	AND Contrasenna = @Contrasenna
	AND Estado = 1
END

--MostrarProductos

CREATE PROCEDURE MostrarProductos
AS
BEGIN
    SELECT 
        p.IdProducto,
        p.nombre AS Producto,
        p.precio AS Precio,
        p.imagen AS Imagen,
        c.NombreCategoria AS Categoria
    FROM 
        Productos p
    INNER JOIN 
        Categorias c ON p.categoria = c.IDCategoria;
END;

-- AgregarProductos

CREATE PROCEDURE AgregarProducto
    @Nombre VARCHAR(50),
    @Precio DECIMAL(10, 2),
    @Imagen VARBINARY(MAX),
    @Categoria INT
AS
BEGIN
    INSERT INTO Productos (nombre, precio, imagen, categoria)
    VALUES (@Nombre, @Precio, @Imagen, @Categoria);
END;

-- ActualizarProducto

CREATE PROCEDURE ActualizarProducto
	@Nombre VARCHAR(100),
	@Precio DECIMAL(10,2),
	@Imagen VARCHAR(255),
	@Categoria INT,
	@IdProducto INT
AS
BEGIN
	UPDATE Productos
	   SET  Nombre = @Nombre,
			Precio = @Precio,
			Imagen = @Imagen,
			Categoria = @Categoria
	 WHERE IdProducto = @IdProducto
END
GO

--Eliminar Productos

CREATE PROCEDURE EliminarProducto
	@IdProducto INT
AS
BEGIN
	DELETE FROM Productos
    WHERE IdProducto = @IdProducto;
END
GO
