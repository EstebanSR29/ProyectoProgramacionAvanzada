@model ProyectoG6.Entidades.Contrasenna

@{
    ViewBag.Title = "Validar Token";
    Layout = "~/Views/Shared/_LayoutExterno.cshtml";
}
<br />
<section class="p-3 p-md-4 p-xl-5 min-vh-100 d-flex align-items-center justify-content-center">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-6 bsb-tpl-bg-lotion rounded-3 shadow-sm">
                <div class="p-4">
                    <div class="row mb-4">
                        <div class="col-12">
                            <h3 class="text-center">Recuperar Contraseña</h3>
                        </div>
                        @if (TempData["ErrorMessage"] != null)
                        {
                            <div class="alert alert-danger alert-dismissible fade show text-center fs-4" role="alert">
                                <i class="bi bi-x-circle-fill" style="color: red;"></i>
                                <br />
                                @TempData["ErrorMessage"]
                            </div>
                        }
                        @if (TempData["SuccessMessage"] != null)
                        {
                            <div class="alert alert-dismissible fade show text-center fs-4" role="alert" style="background-color: white; color: green; border: 1px solid green;">
                                <i class="bi bi-check-circle-fill" style="color: green;"></i>
                                <br />
                                @TempData["SuccessMessage"]
                            </div>
                        }
                    </div>
                    @using (Html.BeginForm("ValidarToken", "Login", FormMethod.Post, new { id = "passwordResetForm" }))
                    {
                        <div class="row gy-3 gy-md-4 overflow-hidden">
                            <div class="col-12">
                                @Html.HiddenFor(m => m.Token, new { id = "Token", name = "Token", value = "@token" })
                            </div>
                            <div class="col-12">
                                <h4 class="text-left mb-2">Nueva Contraseña</h4>
                                @Html.PasswordFor(m => m.NuevaContrasenna, new { id = "NuevaContrasenna", @class = "form-control fs-4", required = "required" })
                            </div>
                            <div class="col-12">
                                <h4 class="text-left mb-2">Confirmar Contraseña</h4>
                                @Html.PasswordFor(m => m.ConfirmarContrasenna, new { id = "ConfirmarContrasenna", @class = "form-control fs-4", required = "required" })
                            </div>
                            <div class="col-12">
                                <div class="d-grid">
                                    <button class="btn bsb-btn-xl btn-primary fs-4" type="submit">Actualizar Contraseña</button>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.getElementById('passwordResetForm').addEventListener('submit', function (event) {
        var nuevaContrasenna = document.getElementById('NuevaContrasenna').value;
        var confirmarContrasenna = document.getElementById('ConfirmarContrasenna').value;

        if (nuevaContrasenna !== confirmarContrasenna) {
            event.preventDefault();

            Swal.fire({
                title: '¡Error!',
                text: 'Las contraseñas no coinciden. Por favor, verifícalas e intenta nuevamente.',
                icon: 'error',
                confirmButtonText: 'OK'
            }).then(() => {
                document.getElementById('NuevaContrasenna').value = '';
                document.getElementById('ConfirmarContrasenna').value = '';
            });
        }
    });
</script>